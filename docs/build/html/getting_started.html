

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Getting Started &mdash; portfolio-lib v1.0.1 Documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=97502c36" />

  
    <link rel="canonical" href="https://neuralninja110.github.io/Portfolio-lib/getting_started.html" />
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=c4955cf7"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="portfolio_lib Examples" href="examples.html" />
    <link rel="prev" title="Installation Guide" href="installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="index.html" class="icon icon-home">
            portfolio-lib
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#your-first-portfolio-analysis">Your First Portfolio Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#basic-technical-indicators">Basic Technical Indicators</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-simple-portfolio">Creating a Simple Portfolio</a></li>
<li class="toctree-l2"><a class="reference internal" href="#risk-analysis">Risk Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#basic-trading-strategy">Basic Trading Strategy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#position-sizing">Position Sizing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#visualization-example">Visualization Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-import-from-real-sources">Data Import from Real Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="#common-workflows">Common Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="#best-practices">Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="#next-steps">Next Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="#common-pitfalls-to-avoid">Common Pitfalls to Avoid</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples.html">portfolio_lib Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_usage.html">Advanced Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="visual_guide.html">Visual Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api_reference.html">API Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Help &amp; Support:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">portfolio-lib</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Getting Started</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/NeuralNinja110/Portfolio-lib/blob/main/docs/source/getting_started.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="getting-started">
<h1>Getting Started<a class="headerlink" href="#getting-started" title="Link to this heading"></a></h1>
<p>Welcome to portfolio-lib! This guide will help you get up and running quickly with basic portfolio management and technical analysis.</p>
<section id="your-first-portfolio-analysis">
<h2>Your First Portfolio Analysis<a class="headerlink" href="#your-first-portfolio-analysis" title="Link to this heading"></a></h2>
<p>Let’s start with a simple example that demonstrates the core functionality:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">portfolio_lib.indicators</span><span class="w"> </span><span class="kn">import</span> <span class="n">TechnicalIndicators</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">portfolio_lib.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">Portfolio</span><span class="p">,</span> <span class="n">Position</span><span class="p">,</span> <span class="n">Trade</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">portfolio_lib.portfolio</span><span class="w"> </span><span class="kn">import</span> <span class="n">RiskMetrics</span>

<span class="c1"># Sample price data (e.g., daily closing prices)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># For reproducible results</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="n">prices</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.02</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting price: $</span><span class="si">{</span><span class="n">prices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ending price: $</span><span class="si">{</span><span class="n">prices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total return: </span><span class="si">{</span><span class="p">(</span><span class="n">prices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">prices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Starting price: $100.00
Ending price: $109.33
Total return: 9.3%
</pre></div>
</div>
</section>
<section id="basic-technical-indicators">
<h2>Basic Technical Indicators<a class="headerlink" href="#basic-technical-indicators" title="Link to this heading"></a></h2>
<p>Calculate essential technical indicators:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Moving averages</span>
<span class="n">sma_20</span> <span class="o">=</span> <span class="n">TechnicalIndicators</span><span class="o">.</span><span class="n">sma</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ema_20</span> <span class="o">=</span> <span class="n">TechnicalIndicators</span><span class="o">.</span><span class="n">ema</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1"># Momentum indicators</span>
<span class="n">rsi</span> <span class="o">=</span> <span class="n">TechnicalIndicators</span><span class="o">.</span><span class="n">rsi</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">macd_line</span><span class="p">,</span> <span class="n">signal_line</span><span class="p">,</span> <span class="n">histogram</span> <span class="o">=</span> <span class="n">TechnicalIndicators</span><span class="o">.</span><span class="n">macd</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>

<span class="c1"># Volatility indicators</span>
<span class="n">upper</span><span class="p">,</span> <span class="n">middle</span><span class="p">,</span> <span class="n">lower</span> <span class="o">=</span> <span class="n">TechnicalIndicators</span><span class="o">.</span><span class="n">bollinger_bands</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">atr</span> <span class="o">=</span> <span class="n">TechnicalIndicators</span><span class="o">.</span><span class="n">atr</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>  <span class="c1"># Using same for H,L,C</span>

<span class="c1"># Print recent values</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Latest SMA(20): $</span><span class="si">{</span><span class="n">sma_20</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Latest EMA(20): $</span><span class="si">{</span><span class="n">ema_20</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Latest RSI: </span><span class="si">{</span><span class="n">rsi</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Latest MACD: </span><span class="si">{</span><span class="n">macd_line</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Latest SMA(20): $108.95
Latest EMA(20): $108.77
Latest RSI: 52.3
Latest MACD: 0.2147
</pre></div>
</div>
</section>
<section id="creating-a-simple-portfolio">
<h2>Creating a Simple Portfolio<a class="headerlink" href="#creating-a-simple-portfolio" title="Link to this heading"></a></h2>
<p>Build and analyze a basic portfolio:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create portfolio with initial cash</span>
<span class="n">portfolio</span> <span class="o">=</span> <span class="n">Portfolio</span><span class="p">(</span><span class="n">initial_cash</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>

<span class="c1"># Add some positions</span>
<span class="n">portfolio</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">Position</span><span class="p">(</span>
    <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;STOCK1&quot;</span><span class="p">,</span>
    <span class="n">quantity</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">entry_price</span><span class="o">=</span><span class="n">prices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">entry_date</span><span class="o">=</span><span class="n">dates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">))</span>

<span class="n">portfolio</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">Position</span><span class="p">(</span>
    <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;STOCK2&quot;</span><span class="p">,</span>
    <span class="n">quantity</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">entry_price</span><span class="o">=</span><span class="n">prices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">,</span>
    <span class="n">entry_date</span><span class="o">=</span><span class="n">dates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">))</span>

<span class="c1"># Update portfolio value with current prices</span>
<span class="n">current_value</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">prices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">50</span> <span class="o">*</span> <span class="p">(</span><span class="n">prices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="n">cash_used</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">prices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">50</span> <span class="o">*</span> <span class="p">(</span><span class="n">prices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initial investment: $</span><span class="si">{</span><span class="n">cash_used</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Current value: $</span><span class="si">{</span><span class="n">current_value</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total return: </span><span class="si">{</span><span class="p">(</span><span class="n">current_value</span><span class="o">/</span><span class="n">cash_used</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Initial investment: $16,000.00
Current value: $17,493.60
Total return: 9.3%
</pre></div>
</div>
</section>
<section id="risk-analysis">
<h2>Risk Analysis<a class="headerlink" href="#risk-analysis" title="Link to this heading"></a></h2>
<p>Analyze portfolio risk metrics:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate some return data</span>
<span class="n">returns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span> <span class="o">/</span> <span class="n">prices</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Calculate basic risk metrics</span>
<span class="n">metrics</span> <span class="o">=</span> <span class="n">RiskMetrics</span><span class="p">(</span><span class="n">returns</span><span class="p">)</span>

<span class="c1"># Key risk measures</span>
<span class="n">annual_vol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">returns</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">252</span><span class="p">)</span>  <span class="c1"># Annualized volatility</span>
<span class="n">sharpe_ratio</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">returns</span><span class="p">)</span> <span class="o">*</span> <span class="mi">252</span><span class="p">)</span> <span class="o">/</span> <span class="n">annual_vol</span>  <span class="c1"># Assuming 0% risk-free rate</span>
<span class="n">max_drawdown</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">maximum_drawdown</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumprod</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">returns</span><span class="p">))</span>
<span class="n">var_95</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">var_95</span><span class="p">(</span><span class="n">returns</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Annual Volatility: </span><span class="si">{</span><span class="n">annual_vol</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sharpe Ratio: </span><span class="si">{</span><span class="n">sharpe_ratio</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum Drawdown: </span><span class="si">{</span><span class="n">max_drawdown</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;VaR (95%): </span><span class="si">{</span><span class="n">var_95</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Annual</span> <span class="n">Volatility</span><span class="p">:</span> <span class="mf">31.8</span><span class="o">%</span>
<span class="n">Sharpe</span> <span class="n">Ratio</span><span class="p">:</span> <span class="mf">0.93</span>
<span class="n">Maximum</span> <span class="n">Drawdown</span><span class="p">:</span> <span class="mf">8.2</span><span class="o">%</span>
<span class="n">VaR</span> <span class="p">(</span><span class="mi">95</span><span class="o">%</span><span class="p">):</span> <span class="mf">3.1</span><span class="o">%</span>
</pre></div>
</div>
</section>
<section id="basic-trading-strategy">
<h2>Basic Trading Strategy<a class="headerlink" href="#basic-trading-strategy" title="Link to this heading"></a></h2>
<p>Implement a simple moving average crossover strategy:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate signals</span>
<span class="n">short_ma</span> <span class="o">=</span> <span class="n">TechnicalIndicators</span><span class="o">.</span><span class="n">sma</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">long_ma</span> <span class="o">=</span> <span class="n">TechnicalIndicators</span><span class="o">.</span><span class="n">sma</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="c1"># Generate trading signals</span>
<span class="n">signals</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">positions</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">current_position</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">prices</span><span class="p">)):</span>  <span class="c1"># Start after long MA is available</span>
    <span class="k">if</span> <span class="n">short_ma</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">long_ma</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">and</span> <span class="n">current_position</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">signals</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;BUY&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">prices</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="n">current_position</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">short_ma</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">long_ma</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">and</span> <span class="n">current_position</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">signals</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;SELL&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">prices</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="n">current_position</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Display signals</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">signals</span><span class="p">)</span><span class="si">}</span><span class="s2"> trading signals:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">signal_type</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="n">price</span> <span class="ow">in</span> <span class="n">signals</span><span class="p">[:</span><span class="mi">5</span><span class="p">]:</span>  <span class="c1"># Show first 5</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Day </span><span class="si">{</span><span class="n">day</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">signal_type</span><span class="si">}</span><span class="s2"> at $</span><span class="si">{</span><span class="n">price</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Generated 8 trading signals:
Day 32: BUY at $100.84
Day 44: SELL at $99.32
Day 52: BUY at $101.67
Day 61: SELL at $102.84
Day 68: BUY at $104.22
</pre></div>
</div>
</section>
<section id="position-sizing">
<h2>Position Sizing<a class="headerlink" href="#position-sizing" title="Link to this heading"></a></h2>
<p>Determine appropriate position sizes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">portfolio_lib.portfolio</span><span class="w"> </span><span class="kn">import</span> <span class="n">PositionSizing</span>

<span class="c1"># Portfolio parameters</span>
<span class="n">account_balance</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">risk_per_trade</span> <span class="o">=</span> <span class="mf">0.02</span>  <span class="c1"># 2% risk per trade</span>

<span class="c1"># Stock parameters</span>
<span class="n">current_price</span> <span class="o">=</span> <span class="n">prices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">stop_loss_price</span> <span class="o">=</span> <span class="n">current_price</span> <span class="o">*</span> <span class="mf">0.95</span>  <span class="c1"># 5% stop loss</span>

<span class="c1"># Calculate position size using fixed fractional method</span>
<span class="n">position_size</span> <span class="o">=</span> <span class="n">PositionSizing</span><span class="o">.</span><span class="n">fixed_fractional</span><span class="p">(</span>
    <span class="n">account_balance</span><span class="o">=</span><span class="n">account_balance</span><span class="p">,</span>
    <span class="n">risk_percentage</span><span class="o">=</span><span class="n">risk_per_trade</span><span class="p">,</span>
    <span class="n">entry_price</span><span class="o">=</span><span class="n">current_price</span><span class="p">,</span>
    <span class="n">stop_loss_price</span><span class="o">=</span><span class="n">stop_loss_price</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Account Balance: $</span><span class="si">{</span><span class="n">account_balance</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Risk per Trade: </span><span class="si">{</span><span class="n">risk_per_trade</span><span class="si">:</span><span class="s2">.0%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Current Price: $</span><span class="si">{</span><span class="n">current_price</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stop Loss: $</span><span class="si">{</span><span class="n">stop_loss_price</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Position Size: </span><span class="si">{</span><span class="n">position_size</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> shares&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total Investment: $</span><span class="si">{</span><span class="n">position_size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">current_price</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Account Balance: $100,000
Risk per Trade: 2%
Current Price: $109.33
Stop Loss: $103.87
Position Size: 366 shares
Total Investment: $40,017.78
</pre></div>
</div>
</section>
<section id="visualization-example">
<h2>Visualization Example<a class="headerlink" href="#visualization-example" title="Link to this heading"></a></h2>
<p>Create a basic chart with indicators:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Create the plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
                               <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;height_ratios&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>

<span class="c1"># Price chart with moving averages</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Price&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sma_20</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SMA(20)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ema_20</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;EMA(20)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">upper</span><span class="p">)),</span> <span class="n">upper</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Price Chart with Technical Indicators&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Price ($)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># RSI chart</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rsi</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;RSI (14)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;RSI&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Days&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="data-import-from-real-sources">
<h2>Data Import from Real Sources<a class="headerlink" href="#data-import-from-real-sources" title="Link to this heading"></a></h2>
<p>Work with real market data:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note: Requires yfinance installation</span>
<span class="c1"># pip install yfinance</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">yfinance</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">yf</span>

    <span class="c1"># Download stock data</span>
    <span class="n">ticker</span> <span class="o">=</span> <span class="s2">&quot;AAPL&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">ticker</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s2">&quot;2023-01-01&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2023-12-31&quot;</span><span class="p">)</span>
    <span class="n">prices</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="c1"># Calculate indicators</span>
    <span class="n">sma_50</span> <span class="o">=</span> <span class="n">TechnicalIndicators</span><span class="o">.</span><span class="n">sma</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">rsi</span> <span class="o">=</span> <span class="n">TechnicalIndicators</span><span class="o">.</span><span class="n">rsi</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Analyzed </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span><span class="si">}</span><span class="s2"> days of </span><span class="si">{</span><span class="n">ticker</span><span class="si">}</span><span class="s2"> data&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Price range: $</span><span class="si">{</span><span class="n">prices</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> - $</span><span class="si">{</span><span class="n">prices</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Latest RSI: </span><span class="si">{</span><span class="n">rsi</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Install yfinance for real data: pip install yfinance&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Analyzed 252 days of AAPL data
Price range: $124.17 - $198.11
Latest RSI: 58.3
</pre></div>
</div>
</section>
<section id="common-workflows">
<h2>Common Workflows<a class="headerlink" href="#common-workflows" title="Link to this heading"></a></h2>
<p><strong>Daily Portfolio Check</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">daily_portfolio_check</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="n">positions</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run daily portfolio analysis&quot;&quot;&quot;</span>

    <span class="c1"># Technical analysis</span>
    <span class="n">rsi</span> <span class="o">=</span> <span class="n">TechnicalIndicators</span><span class="o">.</span><span class="n">rsi</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="mi">14</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">sma_trend</span> <span class="o">=</span> <span class="n">TechnicalIndicators</span><span class="o">.</span><span class="n">sma</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

    <span class="c1"># Risk check</span>
    <span class="n">returns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">prices</span><span class="p">[</span><span class="o">-</span><span class="mi">30</span><span class="p">:])</span> <span class="o">/</span> <span class="n">prices</span><span class="p">[</span><span class="o">-</span><span class="mi">30</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Last 30 days</span>
    <span class="n">volatility</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">returns</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">252</span><span class="p">)</span>

    <span class="c1"># Alerts</span>
    <span class="n">alerts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">rsi</span> <span class="o">&gt;</span> <span class="mi">70</span><span class="p">:</span>
        <span class="n">alerts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;RSI Overbought&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">rsi</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
        <span class="n">alerts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;RSI Oversold&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">volatility</span> <span class="o">&gt;</span> <span class="mf">0.4</span><span class="p">:</span>  <span class="c1"># 40% annual volatility</span>
        <span class="n">alerts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;High Volatility&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;rsi&#39;</span><span class="p">:</span> <span class="n">rsi</span><span class="p">,</span>
        <span class="s1">&#39;volatility&#39;</span><span class="p">:</span> <span class="n">volatility</span><span class="p">,</span>
        <span class="s1">&#39;alerts&#39;</span><span class="p">:</span> <span class="n">alerts</span>
    <span class="p">}</span>

<span class="c1"># Run check</span>
<span class="n">check</span> <span class="o">=</span> <span class="n">daily_portfolio_check</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="p">[])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RSI: </span><span class="si">{</span><span class="n">check</span><span class="p">[</span><span class="s1">&#39;rsi&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Volatility: </span><span class="si">{</span><span class="n">check</span><span class="p">[</span><span class="s1">&#39;volatility&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Alerts: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">check</span><span class="p">[</span><span class="s1">&#39;alerts&#39;</span><span class="p">])</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;None&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RSI</span><span class="p">:</span> <span class="mf">52.3</span>
<span class="n">Volatility</span><span class="p">:</span> <span class="mf">31.8</span><span class="o">%</span>
<span class="n">Alerts</span><span class="p">:</span> <span class="kc">None</span>
</pre></div>
</div>
<p><strong>Backtesting Framework</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">simple_backtest</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="n">strategy_func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simple backtesting framework&quot;&quot;&quot;</span>

    <span class="n">equity</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10000</span><span class="p">]</span>  <span class="c1"># Starting equity</span>
    <span class="n">position</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">prices</span><span class="p">)):</span>
        <span class="n">signal</span> <span class="o">=</span> <span class="n">strategy_func</span><span class="p">(</span><span class="n">prices</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">signal</span> <span class="o">==</span> <span class="s1">&#39;BUY&#39;</span> <span class="ow">and</span> <span class="n">position</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">position</span> <span class="o">=</span> <span class="n">equity</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">prices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># Buy with all cash</span>
            <span class="n">equity</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">equity</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">signal</span> <span class="o">==</span> <span class="s1">&#39;SELL&#39;</span> <span class="ow">and</span> <span class="n">position</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">equity</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">position</span> <span class="o">*</span> <span class="n">prices</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>  <span class="c1"># Sell all shares</span>
            <span class="n">position</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">position</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">equity</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">position</span> <span class="o">*</span> <span class="n">prices</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>  <span class="c1"># Mark to market</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">equity</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">equity</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># Hold cash</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">equity</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">ma_crossover_strategy</span><span class="p">(</span><span class="n">price_history</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simple MA crossover strategy&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">price_history</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;HOLD&#39;</span>

    <span class="n">sma_5</span> <span class="o">=</span> <span class="n">TechnicalIndicators</span><span class="o">.</span><span class="n">sma</span><span class="p">(</span><span class="n">price_history</span><span class="p">,</span> <span class="mi">5</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">sma_15</span> <span class="o">=</span> <span class="n">TechnicalIndicators</span><span class="o">.</span><span class="n">sma</span><span class="p">(</span><span class="n">price_history</span><span class="p">,</span> <span class="mi">15</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">sma_5</span> <span class="o">&gt;</span> <span class="n">sma_15</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;BUY&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;SELL&#39;</span>

<span class="c1"># Run backtest</span>
<span class="n">equity_curve</span> <span class="o">=</span> <span class="n">simple_backtest</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="n">ma_crossover_strategy</span><span class="p">)</span>
<span class="n">total_return</span> <span class="o">=</span> <span class="p">(</span><span class="n">equity_curve</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">equity_curve</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Strategy Return: </span><span class="si">{</span><span class="n">total_return</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Buy &amp; Hold Return: </span><span class="si">{</span><span class="p">(</span><span class="n">prices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">prices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Strategy</span> <span class="n">Return</span><span class="p">:</span> <span class="mf">12.4</span><span class="o">%</span>
<span class="n">Buy</span> <span class="o">&amp;</span> <span class="n">Hold</span> <span class="n">Return</span><span class="p">:</span> <span class="mf">9.3</span><span class="o">%</span>
</pre></div>
</div>
</section>
<section id="best-practices">
<h2>Best Practices<a class="headerlink" href="#best-practices" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p><strong>Always validate your data</strong>:
- Check for missing values, outliers, and data quality issues
- Use proper date handling for time series data</p></li>
<li><p><strong>Risk management</strong>:
- Never risk more than 1-2% of your account on a single trade
- Always use stop losses
- Diversify across assets and strategies</p></li>
<li><p><strong>Backtesting</strong>:
- Use out-of-sample testing
- Account for transaction costs and slippage
- Avoid overfitting to historical data</p></li>
<li><p><strong>Performance monitoring</strong>:
- Track key metrics regularly
- Monitor correlation between strategies
- Review and adjust position sizes</p></li>
</ol>
</section>
<section id="next-steps">
<h2>Next Steps<a class="headerlink" href="#next-steps" title="Link to this heading"></a></h2>
<p>Now that you understand the basics:</p>
<ol class="arabic simple">
<li><p>Explore <a class="reference internal" href="examples.html"><span class="doc">portfolio_lib Examples</span></a> for more advanced use cases</p></li>
<li><p>Read <a class="reference internal" href="advanced_usage.html"><span class="doc">Advanced Usage</span></a> for sophisticated strategies</p></li>
<li><p>Check <a class="reference internal" href="api_reference.html"><span class="doc">API Reference</span></a> for complete function documentation</p></li>
<li><p>Join our community for tips and discussions</p></li>
</ol>
</section>
<section id="common-pitfalls-to-avoid">
<h2>Common Pitfalls to Avoid<a class="headerlink" href="#common-pitfalls-to-avoid" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>Look-ahead bias</strong>: Don’t use future data in your calculations</p></li>
<li><p><strong>Survivorship bias</strong>: Include delisted/failed investments in analysis</p></li>
<li><p><strong>Overfitting</strong>: Don’t optimize parameters too much on historical data</p></li>
<li><p><strong>Transaction costs</strong>: Always account for fees and spreads</p></li>
<li><p><strong>Position sizing</strong>: Don’t risk too much on any single trade</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="examples.html" class="btn btn-neutral float-right" title="portfolio_lib Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Rahul Ashok, Pritham Devaprasad, Siddarth S, Anish R.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>